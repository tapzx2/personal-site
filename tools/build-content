# build content

# for item in layout
#   if item is .html
#      buildHtml(item)
#   if item is directory
#      buildHtml(buildBlurbBody(item))

# def getTitle(page):
#   if page is .html
#     read file
#     find <h1> tag
#     return inner contents of <h1> tag
#   elif page is directory
#     return cleanUp(page)

# def buildHtml(page):
#   if page is string:
#      body = page
#   else:
#      body = read file
#   append(prehead)
#   append(getTitle(page))
#   append(posthead)
#   append(body)
#   append(tail)

# def buildBlurb(page):
#    body = ""
#    blurbs = list(contentes of page).reverseSort
#    for blurb in blurbs:
#       body += blurb
#    return body

import os
import re

index = os.path.expanduser("~/personal-site/www/index.html")
layout = os.path.expanduser("~/personal-site/layout/")

# clear and make freshhhhhhhh
if os.path.isfile(index):
    os.remove(index)
    file = open(f"{index}", "w")
    file.close()


# write output to file
def append(string):
    file1 = open(index, "a")
    file1.write(string)
    file1.close()


# strip sort
def stripSort(string):
    return re.sub('^[0-9]*-', '', string)


# clean string
def cleanUp(string):
    return stripSort(string).replace("-", " ")


# strip html
def striphtml(string):
    return string.replace(".html", "")


head = """<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
"""

body = ""
headers = sorted(os.listdir(layout))
for h3 in headers:
    if h3[0] != ".":
        body += f"<h3>{cleanUp(h3)}</h3>\n"
        for link in sorted(os.listdir(layout+h3)):
            if link[0] != ".":
                if os.path.isdir(layout+h3+"/"+link):
                    body += f'<p><a href="{stripSort(link)}.html">{cleanUp(link)}</a></p>' + '\n'
                else:
                    body += f'<p><a href="{stripSort(link)}">{striphtml(cleanUp(link))}</a></p>' + '\n'

tail = """</body>
</html>
"""


append(head)
append(body)
append(tail)
